name: pm
help: Project manager built on top of tmux
version: 1.0.0

environment_variables:
  - name: PM_ROOT_DIR
    help: Directory where the projects will be managed
    default: ${HOME}/dev

  - name: PM_INSTALL
    help: Directory where the repository was cloned
    default: ${HOME}/.pm

dependencies:
  - git
  - tmux
  - fd
  - gum
  - rg

commands:
  - name: new
    help: Create a new empty project
    group: PROJECT

    args:
      - name: name
        help: Name of the new project
        required: true

    flags:
      - short: -s
        long: --space
        help: Space of the new project
        arg: space
        default: default
        validate: space_exists

      - short: -n
        long: --no-git
        help: Skip git repository initialization

      - short: -d
        long: --detach
        help: Don't attach to the new tmux session

    examples:
      - pm new recipe --detach
      - pm new recipe --no-git --space=tools

  - name: clone
    help: Clone a remote git repository
    group: PROJECT

    args:
      - name: repository
        help: "Remote repository to clone (FORMAT: <username>/<repository>)"
        required: true

      - name: destination
        help: Where to clone the project (relative to ${PM_ROOT_DIR})

    examples:
      - pm clone alexis-moins/portal
      - pm clone alexis-moins/portal personal/portal

  - name: open
    help: Open a project in a tmux session
    group: PROJECT

    args:
      - name: name
        help: Name of the project
        required: true

    examples:
      - pm open school/elixir-api

  - name: filter
    help: Filter projects by name
    group: PROJECT

    examples:
      - pm filter

  - name: dir
    help: Show projects' root directory

    examples:
      - pm dir

  - name: space
    help: Create, delete or list spaces

    commands:
      - name: add
        help: Add new spaces

        catch_all:
          label: directories
          help: Directories to add as spaces
          required: true

        examples:
          - pm space add personal
          - pm space add school/first-year school/second-year

      - name: list
        alias: ls
        help: List registered spaces

        examples:
          - pm space ls
          - pm space list

      - name: remove
        alias: rm
        help: Remove a space (projects will not be removed)

        args:
          - name: space
            help: Name of the space to remove
            required: true

        examples:
          - pm space rm personal
          - pm space remove school/first-year

      - name: filter
        help: Filter spaces by name

        examples:
          - pm space filter

  - name: list
    alias: ls
    help: List project directories

    catch_all:
      label: spaces
      help: Spaces to list projects from
      required: true

  - name: link
    help: Create a link to this script

    args:
      - name: path
        help: Path to the link
        default: ${HOME}/.local/bin

    flags:
      - short: -c
        long: --copy
        help: Copy the script instead of creating a symbolic link
        conflicts: [--remove]

      - short: -r
        long: --remove
        help: Remove the link instead of creating it
        conflicts: [--copy]

    examples:
      - pm link --remove
      - pm link /usr/local/bin

  - name: update
    help: Update to the latest version

    examples:
      - pm update
